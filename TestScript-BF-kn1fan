local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/tbao143/Library-ui/refs/heads/main/Redzhubui"))()
workspace.FallenPartsDestroyHeight = -math.huge

local Window = Library:MakeWindow({
    Title = "lava Hub | Blox Fruits ",
    SubTitle = "by: @kn1fan / lava85halst",
    LoadText = "Loading lava Hub",
    Flags = "ChaosHub_Broookhaven"
})
Window:AddMinimizeButton({
    Button = { Image = "rbxassetid://72674068736695", BackgroundTransparency = 0 },
    Corner = { CornerRadius = UDim.new(35, 1) },
})

local LevelFarm = Window:MakeTab({ Title = "–§–∞—Ä–º lvl", Icon = "rbxassetid://13364900349" })

-- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞—Ä–º–∏–Ω–≥–æ–º —É—Ä–æ–≤–Ω–µ–π
local isLevelFarming = false
local currentSea = 1
local currentQuest = nil
local playerStats = {
    hasFruit = false,
    hasSword = false,
    currentWeapon = nil
}

-- –°–µ–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–æ—Ä–µ–π
LevelFarm:AddSection({ "1 –ú–æ—Ä–µ" })

LevelFarm:AddButton({
    Name = "–í–∫–ª—é—á–∏—Ç—å —Ñ–∞—Ä–º 1 –º–æ—Ä–µ",
    Description = "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∞—Ä–º–∏—Ç —É—Ä–æ–≤–Ω–∏ –Ω–∞ 1 –º–æ—Ä–µ",
    Callback = function()
        if isLevelFarming then
            print("–§–∞—Ä–º–∏–Ω–≥ —É—Ä–æ–≤–Ω–µ–π —É–∂–µ –∑–∞–ø—É—â–µ–Ω")
            return
        end
        
        currentSea = 1
        startLevelFarm()
    end
})

LevelFarm:AddButton({
    Name = "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞—Ä–º",
    Description = "–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–∞—Ä–º–∏–Ω–≥ —É—Ä–æ–≤–Ω–µ–π",
    Callback = function()
        stopLevelFarm()
    end
})

-- –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–∞—Ä–º–∞ —É—Ä–æ–≤–Ω–µ–π
function stopLevelFarm()
    isLevelFarming = false
    print("‚úÖ –§–∞—Ä–º–∏–Ω–≥ —É—Ä–æ–≤–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ä—É–∂–∏—è
local function updatePlayerStats()
    local localPlayer = game:GetService("Players").LocalPlayer
    playerStats.hasFruit = false
    playerStats.hasSword = false
    playerStats.currentWeapon = nil
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ—Ä—É–∫—Ç—ã
    if localPlayer.Character then
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ—Ä—É–∫—Ç–∞ –≤ –±—ç–∫–ø–∞–∫–µ
        local backpack = localPlayer:FindFirstChild("Backpack")
        if backpack then
            for _, item in pairs(backpack:GetChildren()) do
                if item:IsA("Tool") then
                    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—Ä–µ–¥–º–µ—Ç —Ñ—Ä—É–∫—Ç–æ–º (–æ–±—ã—á–Ω–æ —É —Ñ—Ä—É–∫—Ç–æ–≤ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã)
                    if string.find(string.lower(item.Name), "fruit") or 
                       item:FindFirstChild("Fruit") or 
                       item:FindFirstChild("DevilFruit") then
                        playerStats.hasFruit = true
                        playerStats.currentWeapon = "fruit"
                        break
                    end
                end
            end
        end
        
        -- –ï—Å–ª–∏ —Ñ—Ä—É–∫—Ç–∞ –Ω–µ—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—á–∏
        if not playerStats.hasFruit then
            if backpack then
                for _, item in pairs(backpack:GetChildren()) do
                    if item:IsA("Tool") then
                        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—Ä–µ–¥–º–µ—Ç –º–µ—á–æ–º
                        if string.find(string.lower(item.Name), "sword") or 
                           string.find(string.lower(item.Name), "blade") or
                           item:FindFirstChild("Sword") then
                            playerStats.hasSword = true
                            playerStats.currentWeapon = "sword"
                            break
                        end
                    end
                end
            end
        end
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ
        local character = localPlayer.Character
        for _, item in pairs(character:GetChildren()) do
            if item:IsA("Tool") then
                if string.find(string.lower(item.Name), "fruit") or 
                   item:FindFirstChild("Fruit") then
                    playerStats.hasFruit = true
                    playerStats.currentWeapon = "fruit"
                elseif string.find(string.lower(item.Name), "sword") or 
                       string.find(string.lower(item.Name), "blade") then
                    playerStats.hasSword = true
                    playerStats.currentWeapon = "sword"
                end
            end
        end
    end
    
    print("üéí –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ä—É–∂–∏—è - –§—Ä—É–∫—Ç: " .. tostring(playerStats.hasFruit) .. ", –ú–µ—á: " .. tostring(playerStats.hasSword) .. ", –¢–µ–∫—É—â–µ–µ: " .. tostring(playerStats.currentWeapon))
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–≤—ã–±–æ—Ä–∞ –æ—Ä—É–∂–∏—è
local function autoSelectWeapon()
    updatePlayerStats()
    
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character
    if not character then return end
    
    -- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Ñ—Ä—É–∫—Ç > –º–µ—á
    if playerStats.hasFruit then
        -- –ò—â–µ–º —Ñ—Ä—É–∫—Ç –≤ –±—ç–∫–ø–∞–∫–µ –∏ —ç–∫–∏–ø–∏—Ä—É–µ–º
        local backpack = localPlayer:FindFirstChild("Backpack")
        if backpack then
            for _, item in pairs(backpack:GetChildren()) do
                if item:IsA("Tool") and (string.find(string.lower(item.Name), "fruit") or item:FindFirstChild("Fruit")) then
                    -- –≠–∫–∏–ø–∏—Ä—É–µ–º —Ñ—Ä—É–∫—Ç
                    character.Humanoid:EquipTool(item)
                    playerStats.currentWeapon = "fruit"
                    print("üîÆ –≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω —Ñ—Ä—É–∫—Ç: " .. item.Name)
                    return true
                end
            end
        end
    elseif playerStats.hasSword then
        -- –ò—â–µ–º –º–µ—á –≤ –±—ç–∫–ø–∞–∫–µ –∏ —ç–∫–∏–ø–∏—Ä—É–µ–º
        local backpack = localPlayer:FindFirstChild("Backpack")
        if backpack then
            for _, item in pairs(backpack:GetChildren()) do
                if item:IsA("Tool") and (string.find(string.lower(item.Name), "sword") or string.find(string.lower(item.Name), "blade")) then
                    -- –≠–∫–∏–ø–∏—Ä—É–µ–º –º–µ—á
                    character.Humanoid:EquipTool(item)
                    playerStats.currentWeapon = "sword"
                    print("‚öîÔ∏è –≠–∫–∏–ø–∏—Ä–æ–≤–∞–Ω –º–µ—á: " .. item.Name)
                    return true
                end
            end
        end
    end
    
    print("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –æ—Ä—É–∂–∏—è")
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—Ç–∞–∫–∏ –º–æ–±–∞
local function attackMob(mob)
    if not mob or not mob:FindFirstChild("HumanoidRootPart") or not mob:FindFirstChild("Humanoid") then
        return false
    end
    
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then
        return false
    end
    
    -- –ê–≤—Ç–æ–≤—ã–±–æ—Ä –æ—Ä—É–∂–∏—è –ø–µ—Ä–µ–¥ –∞—Ç–∞–∫–æ–π
    if not autoSelectWeapon() then
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–±—Ä–∞—Ç—å –æ—Ä—É–∂–∏–µ –¥–ª—è –∞—Ç–∞–∫–∏")
        return false
    end
    
    local rootPart = character.HumanoidRootPart
    local mobRoot = mob.HumanoidRootPart
    
    -- –ü–æ–¥–ª–µ—Ç–∞–µ–º –∫ –º–æ–±—É –Ω–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –∞—Ç–∞–∫–∏
    local attackDistance = 20
    local currentDistance = (mobRoot.Position - rootPart.Position).Magnitude
    
    if currentDistance > attackDistance then
        safeFlyToPosition(mobRoot.Position + Vector3.new(0, 5, 0), 100)
    end
    
    -- –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—Å—è –∫ –º–æ–±—É
    rootPart.CFrame = CFrame.new(rootPart.Position, Vector3.new(mobRoot.Position.X, rootPart.Position.Y, mobRoot.Position.Z))
    
    -- –õ–æ–≥–∏–∫–∞ –∞—Ç–∞–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Ä—É–∂–∏—è
    if playerStats.currentWeapon == "fruit" then
        -- –ê—Ç–∞–∫–∞ —Ñ—Ä—É–∫—Ç–æ–º
        return useFruitAttack(mob)
    elseif playerStats.currentWeapon == "sword" then
        -- –ê—Ç–∞–∫–∞ –º–µ—á–æ–º
        return useSwordAttack(mob)
    else
        -- –ë–∞–∑–æ–≤–∞—è –∞—Ç–∞–∫–∞ (–µ—Å–ª–∏ –Ω–µ—Ç –æ—Ä—É–∂–∏—è)
        return useBasicAttack(mob)
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—Ç–∞–∫–∏ —Ñ—Ä—É–∫—Ç–æ–º
local function useFruitAttack(mob)
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character
    
    if not character then return false end
    
    -- –ò—â–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—Ä—É–∫—Ç
    local fruitTool = nil
    for _, tool in pairs(character:GetChildren()) do
        if tool:IsA("Tool") and (string.find(string.lower(tool.Name), "fruit") or tool:FindFirstChild("Fruit")) then
            fruitTool = tool
            break
        end
    end
    
    if not fruitTool then
        print("‚ùå –§—Ä—É–∫—Ç –Ω–µ —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω")
        return false
    end
    
    -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞—Ç–∞–∫–∏ —Ñ—Ä—É–∫—Ç–∞
    local success = false
    
    -- –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Ç–∞–∫–∏ —Ñ—Ä—É–∫—Ç–∞
    local attacks = {"Click", "Attack", "Z", "X", "C", "V", "F"}
    
    for _, attackName in pairs(attacks) do
        if not isLevelFarming then break end
        
        local attackEvent = fruitTool:FindFirstChild(attackName)
        if attackEvent and attackEvent:IsA("RemoteEvent") then
            -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞—Ç–∞–∫—É
            pcall(function()
                attackEvent:FireServer()
                print("üîÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∞—Ç–∞–∫–∞ —Ñ—Ä—É–∫—Ç–∞: " .. attackName)
                success = true
            end)
            
            wait(0.5)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–º–µ—Ä –ª–∏ –º–æ–±
            if not mob or not mob.Parent or not mob:FindFirstChild("Humanoid") or mob.Humanoid.Health <= 0 then
                break
            end
        end
    end
    
    return success
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞—Ç–∞–∫–∏ –º–µ—á–æ–º
local function useSwordAttack(mob)
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character
    
    if not character then return false end
    
    -- –ò—â–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—á
    local swordTool = nil
    for _, tool in pairs(character:GetChildren()) do
        if tool:IsA("Tool") and (string.find(string.lower(tool.Name), "sword") or string.find(string.lower(tool.Name), "blade")) then
            swordTool = tool
            break
        end
    end
    
    if not swordTool then
        print("‚ùå –ú–µ—á –Ω–µ —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω")
        return false
    end
    
    -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞—Ç–∞–∫–∏ –º–µ—á–∞
    local success = false
    
    -- –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Ç–∞–∫–∏ –º–µ—á–∞
    local attacks = {"Click", "Attack", "MouseButton1", "SwordSlash"}
    
    for _, attackName in pairs(attacks) do
        if not isLevelFarming then break end
        
        local attackEvent = swordTool:FindFirstChild(attackName)
        if attackEvent and attackEvent:IsA("RemoteEvent") then
            -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞—Ç–∞–∫—É
            pcall(function()
                attackEvent:FireServer()
                print("‚öîÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∞—Ç–∞–∫–∞ –º–µ—á–∞: " .. attackName)
                success = true
            end)
            
            wait(0.3)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–º–µ—Ä –ª–∏ –º–æ–±
            if not mob or not mob.Parent or not mob:FindFirstChild("Humanoid") or mob.Humanoid.Health <= 0 then
                break
            end
        end
    end
    
    return success
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–∞–∑–æ–≤–æ–π –∞—Ç–∞–∫–∏ (–µ—Å–ª–∏ –Ω–µ—Ç –æ—Ä—É–∂–∏—è)
local function useBasicAttack(mob)
    local localPlayer = game:GetService("Players").LocalPlayer
    local character = localPlayer.Character
    
    if not character then return false end
    
    -- –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—É—é –∞—Ç–∞–∫—É (punches)
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞—Ç–∞–∫—É —á–µ—Ä–µ–∑ Humanoid
        pcall(function()
            -- –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ RemoteEvent –¥–ª—è –∞—Ç–∞–∫–∏
            local attackEvent = game:GetService("ReplicatedStorage"):FindFirstChild("CombatRemote")
            if attackEvent and attackEvent:IsA("RemoteEvent") then
                attackEvent:FireServer(mob)
            end
        end)
        
        print("üëä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è –∞—Ç–∞–∫–∞")
        return true
    end
    
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∑—è—Ç–∏—è –∫–≤–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ RemoteEvents
local function takeQuest(questInfo)
    print("üìù –ü—ã—Ç–∞–µ–º—Å—è –≤–∑—è—Ç—å –∫–≤–µ—Å—Ç —É " .. questInfo.npcName)
    
    -- –õ–µ—Ç–∏–º –∫ NPC
    local npcTargetPosition = questInfo.npcPosition + Vector3.new(0, 5, 0)
    local flySuccess = safeFlyToPosition(npcTargetPosition, 120)
    
    if flySuccess then
        wait(2)
        
        -- –ò—â–µ–º NPC —Å–Ω–æ–≤–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        local npc = findNPC(questInfo.npcName)
        if npc then
            print("‚úÖ –ü–æ–¥–æ—à–ª–∏ –∫ NPC: " .. npc.Name)
            
            -- –ü—ã—Ç–∞–µ–º—Å—è –≤–∑—è—Ç—å –∫–≤–µ—Å—Ç —á–µ—Ä–µ–∑ —Ä–∞–∑–ª–∏—á–Ω—ã–µ RemoteEvents
            local remoteNames = {
                "StartQuest",
                "TakeQuest",
                "QuestRemote",
                "AcceptQuest",
                "TalkQuest"
            }
            
            local questTaken = false
            
            for _, remoteName in pairs(remoteNames) do
                if questTaken then break end
                
                -- –ò—â–µ–º RemoteEvent –≤ ReplicatedStorage
                local remote = game:GetService("ReplicatedStorage"):FindFirstChild(remoteName)
                if remote and remote:IsA("RemoteEvent") then
                    pcall(function()
                        remote:FireServer(questInfo.npcName)
                        print("‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –∫–≤–µ—Å—Ç —á–µ—Ä–µ–∑: " .. remoteName)
                        questTaken = true
                    end)
                end
                
                -- –ò—â–µ–º RemoteEvent –≤ NPC
                local npcRemote = npc:FindFirstChild(remoteName)
                if npcRemote and npcRemote:IsA("RemoteEvent") then
                    pcall(function()
                        npcRemote:FireServer()
                        print("‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –∫–≤–µ—Å—Ç —á–µ—Ä–µ–∑ NPC: " .. remoteName)
                        questTaken = true
                    end)
                end
            end
            
            if questTaken then
                currentQuest = questInfo
                print("‚úÖ –ö–≤–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –≤–∑—è—Ç: " .. questInfo.npcName)
                return true
            else
                print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ RemoteEvent –¥–ª—è –≤–∑—è—Ç–∏—è –∫–≤–µ—Å—Ç–∞")
                return false
            end
        else
            print("‚ùå NPC –∏—Å—á–µ–∑ –ø–æ—Å–ª–µ –ø–æ–¥–ª–µ—Ç–∞")
            return false
        end
    else
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–ª–µ—Ç–µ—Ç—å –∫ NPC")
        return false
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–≤–µ—Å—Ç–∞
local function checkQuestProgress()
    local localPlayer = game:GetService("Players").LocalPlayer
    
    if not currentQuest then
        return false
    end
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ PlayerGui
    local playerGui = localPlayer:FindFirstChild("PlayerGui")
    if playerGui then
        -- –ò—â–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–≤–µ—Å—Ç–∞
        for _, screenGui in pairs(playerGui:GetChildren()) do
            if screenGui:IsA("ScreenGui") then
                -- –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞
                local questText = findQuestText(screenGui)
                if questText then
                    -- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –∫–≤–µ—Å—Ç–∞
                    local mobName = currentQuest.mobName
                    if string.find(string.lower(questText), string.lower(mobName)) then
                        -- –ò—â–µ–º —á–∏—Å–ª–∞ –≤ —Ç–µ–∫—Å—Ç–µ (–ø—Ä–æ–≥—Ä–µ—Å—Å)
                        local numbers = {}
                        for number in string.gmatch(questText, "%d+") do
                            table.insert(numbers, tonumber(number))
                        end
                        
                        if #numbers >= 2 then
                            local current = numbers[1]
                            local required = numbers[2]
                            
                            if current >= required then
                                print("‚úÖ –ö–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω! " .. current .. "/" .. required)
                                return true
                            else
                                print("üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞: " .. current .. "/" .. required)
                                return false
                            end
                        end
                    end
                end
            end
        end
    end
    
    -- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
    if localPlayer:FindFirstChild("Data") then
        local data = localPlayer.Data
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –º–µ—Å—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–≤–µ—Å—Ç–∞
        local questProgress = data:FindFirstChild("QuestProgress") or 
                             data:FindFirstChild("CurrentQuest") or
                             data:FindFirstChild("Quest")
        
        if questProgress then
            -- –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —á–µ—Ä–µ–∑ –¥–∞–Ω–Ω—ã–µ
            print("üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞ –≤ –¥–∞–Ω–Ω—ã—Ö: " .. tostring(questProgress.Value))
            -- –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä—ã
        end
    end
    
    return false
end

-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∫–≤–µ—Å—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
local function findQuestText(guiObject)
    if guiObject:IsA("TextLabel") or guiObject:IsA("TextButton") then
        local text = string.lower(guiObject.Text)
        if string.find(text, "quest") or string.find(text, "–∫–≤–µ—Å—Ç") or 
           string.find(text, "mission") or string.find(text, "–∑–∞–¥–∞–Ω–∏–µ") then
            return guiObject.Text
        end
    end
    
    for _, child in pairs(guiObject:GetChildren()) do
        local result = findQuestText(child)
        if result then
            return result
        end
    end
    
    return nil
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–¥–∞—á–∏ –∫–≤–µ—Å—Ç–∞
local function completeQuest()
    if not currentQuest then
        return false
    end
    
    print("üéØ –°–¥–∞–µ–º –∫–≤–µ—Å—Ç...")
    
    -- –õ–µ—Ç–∏–º –æ–±—Ä–∞—Ç–Ω–æ –∫ NPC
    local npcTargetPosition = currentQuest.npcPosition + Vector3.new(0, 5, 0)
    local flySuccess = safeFlyToPosition(npcTargetPosition, 120)
    
    if flySuccess then
        wait(2)
        
        -- –ò—â–µ–º NPC
        local npc = findNPC(currentQuest.npcName)
        if npc then
            -- –ü—ã—Ç–∞–µ–º—Å—è —Å–¥–∞—Ç—å –∫–≤–µ—Å—Ç —á–µ—Ä–µ–∑ RemoteEvents
            local remoteNames = {
                "CompleteQuest",
                "FinishQuest",
                "RewardQuest",
                "EndQuest"
            }
            
            for _, remoteName in pairs(remoteNames) do
                -- –ò—â–µ–º RemoteEvent –≤ ReplicatedStorage
                local remote = game:GetService("ReplicatedStorage"):FindFirstChild(remoteName)
                if remote and remote:IsA("RemoteEvent") then
                    pcall(function()
                        remote:FireServer(currentQuest.npcName)
                        print("‚úÖ –ö–≤–µ—Å—Ç —Å–¥–∞–Ω —á–µ—Ä–µ–∑: " .. remoteName)
                        currentQuest = nil
                        return true
                    end)
                end
                
                -- –ò—â–µ–º RemoteEvent –≤ NPC
                local npcRemote = npc:FindFirstChild(remoteName)
                if npcRemote and npcRemote:IsA("RemoteEvent") then
                    pcall(function()
                        npcRemote:FireServer()
                        print("‚úÖ –ö–≤–µ—Å—Ç —Å–¥–∞–Ω —á–µ—Ä–µ–∑ NPC: " .. remoteName)
                        currentQuest = nil
                        return true
                    end)
                end
            end
        end
    end
    
    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–¥–∞—Ç—å –∫–≤–µ—Å—Ç")
    return false
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–∞—Ä–º–∞ –º–æ–±–æ–≤
local function farmMobs(mobName)
    print("üî´ –ò—â–µ–º –º–æ–±–æ–≤: " .. mobName)
    
    local mobs = {}
    local searchFolders = {
        workspace.Enemies,
        workspace.Mobs,
        workspace.Live
    }
    
    -- –ò—â–µ–º –º–æ–±–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞–ø–∫–∞—Ö
    for _, folder in pairs(searchFolders) do
        if folder then
            for _, mob in pairs(folder:GetChildren()) do
                if mob:IsA("Model") and mob:FindFirstChild("HumanoidRootPart") then
                    local humanoid = mob:FindFirstChildOfClass("Humanoid")
                    if humanoid and humanoid.Health > 0 then
                        if string.lower(mob.Name) == string.lower(mobName) or 
                           string.find(string.lower(mob.Name), string.lower(mobName)) then
                            table.insert(mobs, mob)
                        end
                    end
                end
            end
        end
    end
    
    if #mobs == 0 then
        print("‚ùå –ú–æ–±—ã " .. mobName .. " –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        return false
    end
    
    print("‚úÖ –ù–∞–π–¥–µ–Ω–æ –º–æ–±–æ–≤: " .. #mobs)
    
    -- –ê—Ç–∞–∫—É–µ–º –∫–∞–∂–¥–æ–≥–æ –º–æ–±–∞
    for _, mob in pairs(mobs) do
        if not isLevelFarming then break end
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∞—Ç–∞–∫–æ–π
        if checkQuestProgress() then
            print("üéØ –ö–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º —Ñ–∞—Ä–º –º–æ–±–æ–≤")
            return true
        end
        
        print("üéØ –ê—Ç–∞–∫—É–µ–º –º–æ–±–∞: " .. mob.Name)
        
        -- –ê—Ç–∞–∫—É–µ–º –º–æ–±–∞
        local attackSuccess = attackMob(mob)
        
        if attackSuccess then
            print("‚úÖ –ú–æ–± –∞—Ç–∞–∫–æ–≤–∞–Ω: " .. mob.Name)
        else
            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∞—Ç–∞–∫–æ–≤–∞—Ç—å –º–æ–±–∞: " .. mob.Name)
        end
        
        wait(0.5)
    end
    
    return true
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–∞—Ä–º–∞
function startLevelFarm()
    local Players = game:GetService("Players")
    local localPlayer = Players.LocalPlayer
    
    isLevelFarming = true
    
    print("üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ—Ñ–∞—Ä–º –¥–ª—è " .. currentSea .. " –º–æ—Ä—è")
    
    spawn(function()
        while isLevelFarming do
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–∂ –∂–∏–≤
            if not localPlayer.Character or not localPlayer.Character:FindFirstChild("Humanoid") or 
               localPlayer.Character.Humanoid.Health <= 0 then
                print("üíÄ –ü–µ—Ä—Å–æ–Ω–∞–∂ –º–µ—Ä—Ç–≤, –∂–¥–µ–º —Ä–µ—Å–ø–∞–≤–Ω...")
                wait(5)
                continue
            end
            
            -- –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—Ä—É–∂–∏—è
            updatePlayerStats()
            
            local currentLevel = getPlayerLevel()
            print("üéØ –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: " .. currentLevel)
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω –ª–∏ —Ç–µ–∫—É—â–∏–π –∫–≤–µ—Å—Ç
            if currentQuest and checkQuestProgress() then
                print("‚úÖ –¢–µ–∫—É—â–∏–π –∫–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω, —Å–¥–∞–µ–º...")
                completeQuest()
                currentQuest = nil
                wait(2)
            end
            
            -- –ï—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞, –±–µ—Ä–µ–º –Ω–æ–≤—ã–π
            if not currentQuest then
                local questInfo = getQuestInfo(currentLevel)
                if not questInfo then
                    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–≤–µ—Å—Ç–µ")
                    wait(5)
                    continue
                end
                
                -- –ë–µ—Ä–µ–º –∫–≤–µ—Å—Ç
                local questTaken = takeQuest(questInfo)
                if not questTaken then
                    print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤–∑—è—Ç—å –∫–≤–µ—Å—Ç")
                    wait(3)
                    continue
                end
            end
            
            print("‚úÖ –ö–≤–µ—Å—Ç –∞–∫—Ç–∏–≤–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —Ñ–∞—Ä–º –º–æ–±–æ–≤...")
            
            -- –§–∞—Ä–º–∏–º –º–æ–±–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–∞
            local mobsFarmed = false
            local farmAttempts = 0
            local maxFarmAttempts = 20
            
            while isLevelFarming and not mobsFarmed and farmAttempts < maxFarmAttempts do
                mobsFarmed = farmMobs(currentQuest.mobName)
                farmAttempts = farmAttempts + 1
                
                -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ –ø–æ—Å–ª–µ —Ñ–∞—Ä–º–∞
                if checkQuestProgress() then
                    print("üéØ –ö–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ñ–∞—Ä–º–∞!")
                    mobsFarmed = true
                    break
                end
                
                wait(2)
            end
            
            if checkQuestProgress() then
                print("‚úÖ –ö–≤–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω, —Å–¥–∞–µ–º...")
                completeQuest()
                currentQuest = nil
            elseif mobsFarmed then
                print("‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ñ–∞—Ä–º–∏–ª–∏ –º–æ–±–æ–≤")
            else
                print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—Ñ–∞—Ä–º–∏—Ç—å –º–æ–±–æ–≤ –ø–æ—Å–ª–µ " .. maxFarmAttempts .. " –ø–æ–ø—ã—Ç–æ–∫")
            end
            
            wait(2)
        end
    end)
end

-- –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (findNPC, safeFlyToPosition, getPlayerLevel, getQuestInfo) –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞
