local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/tbao143/Library-ui/refs/heads/main/Redzhubui"))()
workspace.FallenPartsDestroyHeight = -math.huge

local Window = Library:MakeWindow({
    Title = "lava Hub | Blox Fruits ",
    SubTitle = "by: @kn1fan / lava85halst",
    LoadText = "Loading lava Hub",
    Flags = "ChaosHub_Broookhaven"
})
Window:AddMinimizeButton({
    Button = { Image = "rbxassetid://72674068736695", BackgroundTransparency = 0 },
    Corner = { CornerRadius = UDim.new(35, 1) },
})

local InfoTab = Window:MakeTab({ Title = "Info", Icon = "rbxassetid://72674068736695" })

InfoTab:AddSection({ "Script Information" })
InfoTab:AddParagraph({ "Owner / Developer:", "@kn1fan / lava85halst" })
InfoTab:AddParagraph({ "You are using:", "lava Hub Brookhaven " })
InfoTab:AddParagraph({"Your executor:", "Executor Name"})

InfoTab:AddSection({ "Rejoin" })
InfoTab:AddButton({
    Name = "Rejoin",
    Callback = function()
        local TeleportService = game:GetService("TeleportService")
        TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, game.Players.LocalPlayer)
    end
})

local ChestFarm = Window:MakeTab({ Title = "Chest Farm", Icon = "rbxassetid://13364900349" })

ChestFarm:AddSection({ "2 Море" })

local farmEnabled = false
local farmConnection = nil

ChestFarm:AddButton({
    Name = "Включить автофарм сундуков",
    Description = "Автоматически фармит сундуки на втором море",
    Callback = function()
        if farmEnabled then
            Libary:MakeNotification({
                Name = "Chest Farm",
                Content = "Автофарм уже запущен!",
                Time = 3
            })
            return
        end
        
        farmEnabled = true
        
        Libary:MakeNotification({
            Name = "Chest Farm",
            Content = "Автофарм сундуков запущен!",
            Time = 5
        })
        
        -- Основная функция фарма
        local function farmChests()
            local Players = game:GetService("Players")
            local Workspace = game:GetService("Workspace")
            local LocalPlayer = Players.LocalPlayer
            
            while farmEnabled and wait(1) do
                -- Проверяем, жив ли персонаж
                local character = LocalPlayer.Character
                if not character or not character:FindFirstChild("Humanoid") or character.Humanoid.Health <= 0 then
                    wait(2)
                    continue
                end
                
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                if not humanoidRootPart then
                    wait(1)
                    continue
                end
                
                -- Ищем сундуки
                local foundChest = nil
                local shortestDistance = math.huge
                
                for _, obj in pairs(Workspace:GetDescendants()) do
                    if not farmEnabled then break end
                    
                    -- Ищем объекты с названием, содержащим "chest"
                    if obj:IsA("Part") and string.lower(obj.Name):find("chest") then
                        local distance = (humanoidRootPart.Position - obj.Position).Magnitude
                        if distance < shortestDistance then
                            shortestDistance = distance
                            foundChest = obj
                        end
                    end
                end
                
                if foundChest then
                    -- Телепортируемся к сундуку
                    humanoidRootPart.CFrame = foundChest.CFrame + Vector3.new(0, 3, 0)
                    wait(0.5)
                    
                    -- Пытаемся собрать сундук
                    firetouchinterest(humanoidRootPart, foundChest, 0)
                    wait(0.1)
                    firetouchinterest(humanoidRootPart, foundChest, 1)
                    
                    Libary:MakeNotification({
                        Name = "Chest Farm",
                        Content = "Сундук найден! Собираем...",
                        Time = 2
                    })
                else
                    -- Если сундуки не найдены, перемещаемся по точкам второго моря
                    local secondSeaPoints = {
                        Vector3.new(-1200, 50, 800),
                        Vector3.new(-1000, 45, 1000),
                        Vector3.new(-800, 55, 1200),
                        Vector3.new(-600, 48, 1400),
                        Vector3.new(-1400, 52, 600)
                    }
                    
                    local randomPoint = secondSeaPoints[math.random(1, #secondSeaPoints)]
                    humanoidRootPart.CFrame = CFrame.new(randomPoint)
                    
                    Libary:MakeNotification({
                        Name = "Chest Farm",
                        Content = "Сундуки не найдены, перемещаемся...",
                        Time = 2
                    })
                end
                
                wait(3) -- Задержка между поисками
            end
        end
        
        -- Запускаем фарм в отдельном потоке
        farmConnection = game:GetService("RunService").Heartbeat:Connect(function()
            if farmEnabled then
                pcall(farmChests)
            end
        end)
    end
})

ChestFarm:AddButton({
    Name = "Остановить автофарм",
    Description = "Останавливает фарм сундуков",
    Callback = function()
        farmEnabled = false
        if farmConnection then
            farmConnection:Disconnect()
            farmConnection = nil
        end
        
        Libary:MakeNotification({
            Name = "Chest Farm",
            Content = "Автофарм сундуков остановлен!",
            Time = 5
        })
    end
})

ChestFarm:AddToggle({
    Name = "Авто-респавн",
    Description = "Автоматически респавнит персонажа при смерти",
    Default = false,
    Callback = function(value)
        if value then
            -- Код для авто-респавна
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer
            
            LocalPlayer.CharacterAdded:Connect(function(character)
                if farmEnabled then
                    wait(3) -- Ждем 3 секунды после респавна
                    Libary:MakeNotification({
                        Name = "Chest Farm",
                        Content = "Персонаж респавнен, продолжаем фарм!",
                        Time = 3
                    })
                end
            end)
        end
    end
})
